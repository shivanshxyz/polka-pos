(function(F,K){typeof exports=="object"&&typeof module<"u"?K(exports):typeof define=="function"&&define.amd?define(["exports"],K):(F=typeof globalThis<"u"?globalThis:F||self,K(F.papiSigner={}))})(this,function(F){"use strict";const K="0123456789abcdef";function fe(e){const t=new Array(e.length+1);t[0]="0x";for(let n=0;n<e.length;){const r=e[n++];t[n]=K[r>>4]+K[r&15]}return t.join("")}const de={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,b:11,c:12,d:13,e:14,f:15,A:10,B:11,C:12,D:13,E:14,F:15};function ve(e){const t=e.length%2,n=(e[1]==="x"?2:0)+t,r=(e.length-n)/2+t,s=new Uint8Array(r);t&&(s[0]=0|de[e[2]]);for(let i=0;i<r;){const o=n+i*2,c=de[e[o]],h=de[e[o+1]];s[t+i++]=c<<4|h}return s}const G=(...e)=>{const t=e.reduce((r,s)=>r+s.byteLength,0),n=new Uint8Array(t);for(let r=0,s=0;r<e.length;r++){const i=e[r];n.set(i,s),s+=i.byteLength}return n};var wt=Object.defineProperty,mt=(e,t,n)=>t in e?wt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ue=(e,t,n)=>(mt(e,typeof t!="symbol"?t+"":t,n),n),pe={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,b:11,c:12,d:13,e:14,f:15,A:10,B:11,C:12,D:13,E:14,F:15};function xt(e){const t=e.length%2,n=(e[1]==="x"?2:0)+t,r=(e.length-n)/2+t,s=new Uint8Array(r);t&&(s[0]=0|pe[e[2]]);for(let i=0;i<r;){const o=n+i*2,c=pe[e[o]],h=pe[e[o+1]];s[t+i++]=c<<4|h}return s}var _e=class extends Uint8Array{constructor(e){super(e),Ue(this,"i",0),Ue(this,"v"),this.v=new DataView(e)}},O=e=>t=>e(t instanceof _e?t:new _e(t instanceof Uint8Array?t.buffer:typeof t=="string"?xt(t).buffer:t)),D=e=>{const t=e.length;let n=0;for(let s=0;s<t;s++)n+=e[s].length;const r=new Uint8Array(n);for(let s=0,i=0;s<t;s++){const o=e[s];r.set(o,i),i+=o.byteLength}return r};function te(e,t){const n=Object.keys(e),r=n.length,s={};for(let i=0;i<r;i++){const o=n[i];s[o]=t(e[o],o)}return s}var B=(e,t)=>{const n=[e,t];return n.enc=e,n.dec=t,n},ye=(e,t)=>n=>e(t(n)),ke=(e,t)=>n=>t(e(n)),ne=([e,t],n,r)=>B(ye(e,n),ke(t,r));function Et(e,t){return O(n=>{const r=n.v[t](n.i,!0);return n.i+=e,r})}function bt(e,t){return n=>{const r=new Uint8Array(e);return new DataView(r.buffer)[t](0,n,!0),r}}function C(e,t,n){return B(bt(e,n),Et(e,t))}var I=C(1,"getUint8","setUint8"),re=C(2,"getUint16","setUint16"),W=C(4,"getUint32","setUint32"),Oe=C(8,"getBigUint64","setBigUint64");C(1,"getInt8","setInt8"),C(2,"getInt16","setInt16"),C(4,"getInt32","setInt32"),C(8,"getBigInt64","setBigInt64");var De=e=>{const t=new Uint8Array(16),n=new DataView(t.buffer);return n.setBigInt64(0,e,!0),n.setBigInt64(8,e>>64n,!0),t},Te=e=>O(t=>{const{v:n,i:r}=t,s=n.getBigUint64(r,!0),i=n[e](r+8,!0);return t.i+=16,i<<64n|s});B(De,Te("getBigUint64")),B(De,Te("getBigInt64"));var Le=e=>{const t=new Uint8Array(32),n=new DataView(t.buffer);return n.setBigInt64(0,e,!0),n.setBigInt64(8,e>>64n,!0),n.setBigInt64(16,e>>128n,!0),n.setBigInt64(24,e>>192n,!0),t},Se=e=>O(t=>{let n=t.v.getBigUint64(t.i,!0);return t.i+=8,n|=t.v.getBigUint64(t.i,!0)<<64n,t.i+=8,n|=t.v.getBigUint64(t.i,!0)<<128n,t.i+=8,n|=t.v[e](t.i,!0)<<192n,t.i+=8,n});B(Le,Se("getBigUint64")),B(Le,Se("getBigInt64")),ne(I,e=>e?1:0,Boolean);var Bt=[I[1],re[1],W[1]],At=O(e=>{const t=e[e.i],n=t&3;if(n<3)return Bt[n](e)>>>2;const r=(t>>>2)+4;e.i++;let s=0n;const i=r/8|0;let o=0n;for(let h=0;h<i;h++)s=Oe[1](e)<<o|s,o+=64n;let c=r%8;return c>3&&(s=BigInt(W[1](e))<<o|s,o+=32n,c-=4),c>1&&(s=BigInt(re[1](e))<<o|s,o+=16n,c-=2),c&&(s=BigInt(I[1](e))<<o|s),s}),It=1n<<56n,Ut=1<<24,_t=256,kt=4294967295n,Ot=64,Dt=16384,Tt=1<<30,Lt=e=>{if(e<0)throw new Error(`Wrong compact input (${e})`);const t=Number(e)<<2;if(e<Ot)return I[0](t);if(e<Dt)return re[0](t|1);if(e<Tt)return W[0](t|2);let n=[new Uint8Array(1)],r=BigInt(e);for(;r>=It;)n.push(Oe[0](r)),r>>=64n;r>=Ut&&(n.push(W[0](Number(r&kt))),r>>=32n);let s=Number(r);s>=_t&&(n.push(re[0](s)),s>>=16),s&&n.push(I[0](s));const i=D(n);return i[0]=i.length-5<<2|3,i},k=B(Lt,At),St=new TextEncoder,Mt=e=>{const t=St.encode(e);return D([k.enc(t.length),t])},$t=new TextDecoder,Ct=O(e=>{let t=k.dec(e);const n=new DataView(e.buffer,e.i,t);return e.i+=t,$t.decode(n)}),U=B(Mt,Ct),Nt=()=>{},Vt=new Uint8Array(0),m=B(()=>Vt,Nt),Me=e=>e===void 0?t=>D([k.enc(t.length),t]):t=>t.length===e?t:t.slice(0,e),$e=e=>O(t=>{const n=e===void 0?k.dec(t):e!==1/0?e:t.byteLength-t.i,r=new Uint8Array(t.buffer.slice(t.i,t.i+n));return t.i+=n,r}),P=e=>B(Me(e),$e(e));P.enc=Me,P.dec=$e;var Ce=(e,t)=>{const n=Object.keys(e),r=new Map(t?.map((i,o)=>[n[o],i])??n.map((i,o)=>[i,o])),s=i=>r.get(i);return({tag:i,value:o})=>D([I.enc(s(i)),e[i](o)])},Ne=(e,t)=>{const n=Object.keys(e),r=new Map(t?.map((s,i)=>[s,n[i]])??n.map((s,i)=>[i,s]));return O(s=>{const i=I.dec(s),o=r.get(i),c=e[o];return{tag:o,value:c(s)}})},j=(e,...t)=>B(Ce(te(e,([n])=>n),...t),Ne(te(e,([,n])=>n),...t));j.enc=Ce,j.dec=Ne;var Ve=e=>O(t=>I[1](t)>0?e(t):void 0),He=e=>t=>{const n=new Uint8Array(1);return t===void 0?n:(n[0]=1,D([n,e(t)]))},T=e=>B(He(e[0]),Ve(e[1]));T.enc=He,T.dec=Ve;var Pe=(...e)=>O(t=>e.map(n=>n(t))),je=(...e)=>t=>D(e.map((n,r)=>n(t[r]))),q=(...e)=>B(je(...e.map(([t])=>t)),Pe(...e.map(([,t])=>t)));q.enc=je,q.dec=Pe;var qe=e=>{const t=Object.keys(e);return ye(q.enc(...Object.values(e)),n=>t.map(r=>n[r]))},Re=e=>{const t=Object.keys(e);return ke(q.dec(...Object.values(e)),n=>Object.fromEntries(n.map((r,s)=>[t[s],r])))},w=e=>B(qe(te(e,t=>t[0])),Re(te(e,t=>t[1])));w.enc=qe,w.dec=Re;var Ke=(e,t)=>t>=0?n=>D(n.map(e)):n=>D([k.enc(n.length),D(n.map(e))]),We=(e,t)=>O(n=>{const r=t>=0?t:k.dec(n),s=new Array(r);for(let i=0;i<r;i++)s[i]=e(n);return s}),E=(e,t)=>B(Ke(e[0],t),We(e[1],t));E.enc=Ke,E.dec=We;/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Ht(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function Xe(e,t){return Array.isArray(t)?t.length===0?!0:e?t.every(n=>typeof n=="string"):t.every(n=>Number.isSafeInteger(n)):!1}function ge(e,t){if(typeof t!="string")throw new Error(`${e}: string expected`);return!0}function Fe(e){if(!Number.isSafeInteger(e))throw new Error(`invalid integer: ${e}`)}function we(e){if(!Array.isArray(e))throw new Error("array expected")}function Ge(e,t){if(!Xe(!0,t))throw new Error(`${e}: array of strings expected`)}function Pt(e,t){if(!Xe(!1,t))throw new Error(`${e}: array of numbers expected`)}function jt(...e){const t=i=>i,n=(i,o)=>c=>i(o(c)),r=e.map(i=>i.encode).reduceRight(n,t),s=e.map(i=>i.decode).reduce(n,t);return{encode:r,decode:s}}function qt(e){const t=typeof e=="string"?e.split(""):e,n=t.length;Ge("alphabet",t);const r=new Map(t.map((s,i)=>[s,i]));return{encode:s=>(we(s),s.map(i=>{if(!Number.isSafeInteger(i)||i<0||i>=n)throw new Error(`alphabet.encode: digit index outside alphabet "${i}". Allowed: ${e}`);return t[i]})),decode:s=>(we(s),s.map(i=>{ge("alphabet.decode",i);const o=r.get(i);if(o===void 0)throw new Error(`Unknown letter: "${i}". Allowed: ${e}`);return o}))}}function Rt(e=""){return ge("join",e),{encode:t=>(Ge("join.decode",t),t.join(e)),decode:t=>(ge("join.decode",t),t.split(e))}}function ze(e,t,n){if(t<2)throw new Error(`convertRadix: invalid from=${t}, base cannot be less than 2`);if(n<2)throw new Error(`convertRadix: invalid to=${n}, base cannot be less than 2`);if(we(e),!e.length)return[];let r=0;const s=[],i=Array.from(e,c=>{if(Fe(c),c<0||c>=t)throw new Error(`invalid integer: ${c}`);return c}),o=i.length;for(;;){let c=0,h=!0;for(let p=r;p<o;p++){const v=i[p],l=t*c,u=l+v;if(!Number.isSafeInteger(u)||l/t!==c||u-v!==l)throw new Error("convertRadix: carry overflow");const g=u/n;c=u%n;const f=Math.floor(g);if(i[p]=f,!Number.isSafeInteger(f)||f*n+c!==u)throw new Error("convertRadix: carry overflow");if(h)f?h=!1:r=p;else continue}if(s.push(c),h)break}for(let c=0;c<e.length-1&&e[c]===0;c++)s.push(0);return s.reverse()}function Kt(e){Fe(e);const t=2**8;return{encode:n=>{if(!Ht(n))throw new Error("radix.encode input should be Uint8Array");return ze(Array.from(n),t,e)},decode:n=>(Pt("radix.decode",n),Uint8Array.from(ze(n,e,t)))}}const Ye=(e=>jt(Kt(58),qt(e),Rt("")))("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz");/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Wt(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function me(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function xe(e,...t){if(!Wt(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function Je(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Xt(e,t){xe(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function se(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function Ee(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}const Qe=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function Ze(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}const L=Qe?e=>e:e=>Ze(e);function Ft(e){for(let t=0;t<e.length;t++)e[t]=Ze(e[t]);return e}const X=Qe?e=>e:Ft;function Gt(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function z(e){return typeof e=="string"&&(e=Gt(e)),xe(e),e}class zt{}function Yt(e){const t=(r,s)=>e(s).update(z(r)).digest(),n=e({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}const Jt=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]),ie=BigInt(2**32-1),et=BigInt(32);function Qt(e,t=!1){return t?{h:Number(e&ie),l:Number(e>>et&ie)}:{h:Number(e>>et&ie)|0,l:Number(e&ie)|0}}const tt=(e,t,n)=>e>>>n|t<<32-n,nt=(e,t,n)=>e<<32-n|t>>>n,Zt=(e,t,n)=>e<<64-n|t>>>n-32,en=(e,t,n)=>e>>>n-32|t<<64-n,tn=(e,t)=>t,nn=(e,t)=>e;function rt(e,t,n,r){const s=(t>>>0)+(r>>>0);return{h:e+n+(s/2**32|0)|0,l:s|0}}const st=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),it=(e,t,n,r)=>t+n+r+(e/2**32|0)|0,b=Uint32Array.from([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),a=new Uint32Array(32);function N(e,t,n,r,s,i){const o=s[i],c=s[i+1];let h=a[2*e],p=a[2*e+1],v=a[2*t],l=a[2*t+1],u=a[2*n],g=a[2*n+1],f=a[2*r],d=a[2*r+1],x=st(h,v,o);p=it(x,p,l,c),h=x|0,{Dh:d,Dl:f}={Dh:d^p,Dl:f^h},{Dh:d,Dl:f}={Dh:tn(d,f),Dl:nn(d)},{h:g,l:u}=rt(g,u,d,f),{Bh:l,Bl:v}={Bh:l^g,Bl:v^u},{Bh:l,Bl:v}={Bh:tt(l,v,24),Bl:nt(l,v,24)},a[2*e]=h,a[2*e+1]=p,a[2*t]=v,a[2*t+1]=l,a[2*n]=u,a[2*n+1]=g,a[2*r]=f,a[2*r+1]=d}function V(e,t,n,r,s,i){const o=s[i],c=s[i+1];let h=a[2*e],p=a[2*e+1],v=a[2*t],l=a[2*t+1],u=a[2*n],g=a[2*n+1],f=a[2*r],d=a[2*r+1],x=st(h,v,o);p=it(x,p,l,c),h=x|0,{Dh:d,Dl:f}={Dh:d^p,Dl:f^h},{Dh:d,Dl:f}={Dh:tt(d,f,16),Dl:nt(d,f,16)},{h:g,l:u}=rt(g,u,d,f),{Bh:l,Bl:v}={Bh:l^g,Bl:v^u},{Bh:l,Bl:v}={Bh:Zt(l,v,63),Bl:en(l,v,63)},a[2*e]=h,a[2*e+1]=p,a[2*t]=v,a[2*t+1]=l,a[2*n]=u,a[2*n+1]=g,a[2*r]=f,a[2*r+1]=d}function rn(e,t={},n,r,s){if(me(n),e<0||e>n)throw new Error("outputLen bigger than keyLen");const{key:i,salt:o,personalization:c}=t;if(i!==void 0&&(i.length<1||i.length>n))throw new Error("key length must be undefined or 1.."+n);if(o!==void 0&&o.length!==r)throw new Error("salt must be undefined or "+r);if(c!==void 0&&c.length!==s)throw new Error("personalization must be undefined or "+s)}class sn extends zt{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,this.length=0,this.pos=0,me(t),me(n),this.blockLen=t,this.outputLen=n,this.buffer=new Uint8Array(t),this.buffer32=se(this.buffer)}update(t){Je(this),t=z(t),xe(t);const{blockLen:n,buffer:r,buffer32:s}=this,i=t.length,o=t.byteOffset,c=t.buffer;for(let h=0;h<i;){this.pos===n&&(X(s),this.compress(s,0,!1),X(s),this.pos=0);const p=Math.min(n-this.pos,i-h),v=o+h;if(p===n&&!(v%4)&&h+p<i){const l=new Uint32Array(c,v,Math.floor((i-h)/4));X(l);for(let u=0;h+n<i;u+=s.length,h+=n)this.length+=n,this.compress(l,u,!1);X(l);continue}r.set(t.subarray(h,h+p),this.pos),this.pos+=p,this.length+=p,h+=p}return this}digestInto(t){Je(this),Xt(t,this);const{pos:n,buffer32:r}=this;this.finished=!0,Ee(this.buffer.subarray(n)),X(r),this.compress(r,0,!0),X(r);const s=se(t);this.get().forEach((i,o)=>s[o]=L(i))}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){const{buffer:n,length:r,finished:s,destroyed:i,outputLen:o,pos:c}=this;return t||(t=new this.constructor({dkLen:o})),t.set(...this.get()),t.buffer.set(n),t.destroyed=i,t.finished=s,t.length=r,t.pos=c,t.outputLen=o,t}clone(){return this._cloneInto()}}class on extends sn{constructor(t={}){const n=t.dkLen===void 0?64:t.dkLen;super(128,n),this.v0l=b[0]|0,this.v0h=b[1]|0,this.v1l=b[2]|0,this.v1h=b[3]|0,this.v2l=b[4]|0,this.v2h=b[5]|0,this.v3l=b[6]|0,this.v3h=b[7]|0,this.v4l=b[8]|0,this.v4h=b[9]|0,this.v5l=b[10]|0,this.v5h=b[11]|0,this.v6l=b[12]|0,this.v6h=b[13]|0,this.v7l=b[14]|0,this.v7h=b[15]|0,rn(n,t,64,16,16);let{key:r,personalization:s,salt:i}=t,o=0;if(r!==void 0&&(r=z(r),o=r.length),this.v0l^=this.outputLen|o<<8|65536|1<<24,i!==void 0){i=z(i);const c=se(i);this.v4l^=L(c[0]),this.v4h^=L(c[1]),this.v5l^=L(c[2]),this.v5h^=L(c[3])}if(s!==void 0){s=z(s);const c=se(s);this.v6l^=L(c[0]),this.v6h^=L(c[1]),this.v7l^=L(c[2]),this.v7h^=L(c[3])}if(r!==void 0){const c=new Uint8Array(this.blockLen);c.set(r),this.update(c)}}get(){let{v0l:t,v0h:n,v1l:r,v1h:s,v2l:i,v2h:o,v3l:c,v3h:h,v4l:p,v4h:v,v5l:l,v5h:u,v6l:g,v6h:f,v7l:d,v7h:x}=this;return[t,n,r,s,i,o,c,h,p,v,l,u,g,f,d,x]}set(t,n,r,s,i,o,c,h,p,v,l,u,g,f,d,x){this.v0l=t|0,this.v0h=n|0,this.v1l=r|0,this.v1h=s|0,this.v2l=i|0,this.v2h=o|0,this.v3l=c|0,this.v3h=h|0,this.v4l=p|0,this.v4h=v|0,this.v5l=l|0,this.v5h=u|0,this.v6l=g|0,this.v6h=f|0,this.v7l=d|0,this.v7h=x|0}compress(t,n,r){this.get().forEach((h,p)=>a[p]=h),a.set(b,16);let{h:s,l:i}=Qt(BigInt(this.length));a[24]=b[8]^i,a[25]=b[9]^s,r&&(a[28]=~a[28],a[29]=~a[29]);let o=0;const c=Jt;for(let h=0;h<12;h++)N(0,4,8,12,t,n+2*c[o++]),V(0,4,8,12,t,n+2*c[o++]),N(1,5,9,13,t,n+2*c[o++]),V(1,5,9,13,t,n+2*c[o++]),N(2,6,10,14,t,n+2*c[o++]),V(2,6,10,14,t,n+2*c[o++]),N(3,7,11,15,t,n+2*c[o++]),V(3,7,11,15,t,n+2*c[o++]),N(0,5,10,15,t,n+2*c[o++]),V(0,5,10,15,t,n+2*c[o++]),N(1,6,11,12,t,n+2*c[o++]),V(1,6,11,12,t,n+2*c[o++]),N(2,7,8,13,t,n+2*c[o++]),V(2,7,8,13,t,n+2*c[o++]),N(3,4,9,14,t,n+2*c[o++]),V(3,4,9,14,t,n+2*c[o++]);this.v0l^=a[0]^a[16],this.v0h^=a[1]^a[17],this.v1l^=a[2]^a[18],this.v1h^=a[3]^a[19],this.v2l^=a[4]^a[20],this.v2h^=a[5]^a[21],this.v3l^=a[6]^a[22],this.v3h^=a[7]^a[23],this.v4l^=a[8]^a[24],this.v4h^=a[9]^a[25],this.v5l^=a[10]^a[26],this.v5h^=a[11]^a[27],this.v6l^=a[12]^a[28],this.v6h^=a[13]^a[29],this.v7l^=a[14]^a[30],this.v7h^=a[15]^a[31],Ee(a)}destroy(){this.destroyed=!0,Ee(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const be=Yt(e=>new on(e)),ot=new TextEncoder().encode("SS58PRE"),Be=2,cn=e=>{try{const t=Ye.decode(e),n=t.subarray(0,t[0]&64?2:1),r=t.subarray(n.length,t.length-Be),s=t.subarray(n.length+r.length),i=be(Uint8Array.of(...ot,...n,...r),{dkLen:64}).subarray(0,Be);return s[0]===i[0]&&s[1]===i[1]?{isValid:!0,ss58Format:an(n),publicKey:r.slice()}:{isValid:!1}}catch{return{isValid:!1}}},an=e=>{const t=new DataView(e.buffer,e.byteOffset,e.byteLength);return t.byteLength===1?t.getUint8(0):t.getUint16(0)},un=e=>{const t=e<64?Uint8Array.of(e):Uint8Array.of((e&252)>>2|64,e>>8|(e&3)<<6);return n=>{const r=be(Uint8Array.of(...ot,...t,...n),{dkLen:64}).subarray(0,Be);return Ye.encode(Uint8Array.of(...t,...n,...r))}};function ln(e,t){return n=>{const r=cn(n);if(!r.isValid)throw new Error("Invalid checksum");const{publicKey:s}=r;if(s.length!==e)throw new Error("Invalid public key length");return s}}const hn=(e=42,t=32)=>ne(P(t),ln(t),un(e));var fn=Object.defineProperty,ct=e=>{throw TypeError(e)},dn=(e,t,n)=>t in e?fn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Y=(e,t,n)=>dn(e,typeof t!="symbol"?t+"":t,n),at=(e,t,n)=>t.has(e)||ct("Cannot "+n),S=(e,t,n)=>(at(e,t,"read from private field"),n?n.call(e):t.get(e)),J=(e,t,n)=>t.has(e)?ct("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),R=(e,t,n,r)=>(at(e,t,"write to private field"),t.set(e,n),n),M,Q,oe,ce,ae;const vn=new TextEncoder,pn=new TextDecoder,yn=q(k,P(1/0))[1];class gn{constructor(t,n=!1){if(J(this,M),J(this,Q,null),J(this,oe,null),J(this,ce,null),J(this,ae,null),Y(this,"asText",()=>S(this,ae)??R(this,ae,pn.decode(S(this,M)))),Y(this,"asHex",()=>S(this,oe)||R(this,oe,fe(S(this,M)))),Y(this,"asOpaqueHex",()=>S(this,ce)||R(this,ce,fe(this.asBytes()))),Y(this,"asBytes",()=>S(this,M)),Y(this,"asOpaqueBytes",()=>S(this,Q)||R(this,Q,G(k[0](S(this,M).length),S(this,M)))),n){try{const[r,s]=yn(t);if(r===s.length){R(this,M,s),R(this,Q,t);return}}catch{}throw new Error("Invalid opaque bytes")}else R(this,M,t)}static fromText(t){return new this(vn.encode(t))}static fromHex(t){return new this(ve(t))}static fromOpaqueHex(t){return new this(ve(t),!0)}static fromBytes(t){return new this(t)}static fromOpaqueBytes(t){return new this(t,!0)}}M=new WeakMap,Q=new WeakMap,oe=new WeakMap,ce=new WeakMap,ae=new WeakMap;const[Zn]=hn(),y=ne(k,e=>e,Number);ne(k,e=>e,BigInt);const ut=e=>{const t=P.enc(e);return n=>t(ve(n))},lt=e=>{const t=P.dec(e);return n=>fe(t(n))},Z=e=>B(ut(e),lt(e));Z.enc=ut,Z.dec=lt;const $=E(U),ht=T(U),wn=j({bool:m,char:m,str:m,u8:m,u16:m,u32:m,u64:m,u128:m,u256:m,i8:m,i16:m,i32:m,i64:m,i128:m,i256:m}),ft=E(w({name:ht,type:y,typeName:ht,docs:$})),mn=w({len:W,type:y}),xn=w({bitStoreType:y,bitOrderType:y}),En=E(w({name:U,fields:ft,index:I,docs:$})),bn=j({composite:ft,variant:En,sequence:y,array:mn,tuple:E(y),primitive:wn,compact:y,bitSequence:xn}),Bn=w({name:U,type:T(y)}),An=E(Bn),In=w({id:y,path:$,params:An,def:bn,docs:$}),dt=E(In),Un=j({Blake2128:m,Blake2256:m,Blake2128Concat:m,Twox128:m,Twox256:m,Twox64Concat:m,Identity:m}),_n=E(Un),kn=w({hashers:_n,key:y,value:y}),On=w({name:U,modifier:I,type:j({plain:y,map:kn}),fallback:Z(),docs:$}),Dn=T(w({prefix:U,items:E(On)})),vt={name:U,storage:Dn,calls:T(y),events:T(y),constants:E(w({name:U,type:y,value:Z(),docs:$})),errors:T(y),index:I},Tn={...vt,docs:$},Ln=new Uint8Array,pt=e=>B(()=>Ln,()=>e),Sn=w({type:y,version:I,signedExtensions:E(w({identifier:U,type:y,additionalSigned:y}))}),Mn=w({lookup:dt,pallets:E(w({...vt,docs:pt([])})),extrinsic:Sn,type:y,apis:pt([])}),$n=w({name:U,methods:E(w({name:U,inputs:E(w({name:U,type:y})),output:y,docs:$})),docs:$}),Cn=w({version:I,address:y,call:y,signature:y,extra:y,signedExtensions:E(w({identifier:U,type:y,additionalSigned:y}))}),Nn=w({lookup:dt,pallets:E(w(Tn)),extrinsic:Cn,type:y,apis:E($n),outerEnums:w({call:y,event:y,error:y}),custom:E(q(U,w({type:y,value:Z()})))}),yt=()=>{throw new Error("Unsupported metadata version!")},_=B(yt,yt),ue=w({magicNumber:W,metadata:j({v0:_,v1:_,v2:_,v3:_,v4:_,v5:_,v6:_,v7:_,v8:_,v9:_,v10:_,v11:_,v12:_,v13:_,v14:Mn,v15:Nn})}),Ae=P(),Vn=T(Ae),Hn=q(k,Ae),Pn=e=>{try{return ue.dec(e)}catch{}try{return ue.dec(Vn.dec(e))}catch{}try{return ue.dec(Ae.dec(e))}catch{}try{return ue.dec(Hn.dec(e)[1])}catch{}throw null},jn={dkLen:32},qn=e=>be(e,jn),gt=(e,t)=>e.type==="array"&&e.len===t&&e.value.type==="primitive"&&e.value.value==="u8",H={type:"void"},Rn=(e,t=()=>null)=>{const n=new Map,r=new Set,s=v=>l=>{let u=n.get(l);if(u)return u;if(r.has(l)){const f={id:l};return n.set(l,f),f}r.add(l);const g=v(l);return u=n.get(l),u?Object.assign(u,g):(u={id:l,...g},n.set(l,u)),r.delete(l),u};let i=!0,o=!0;const c=s(v=>{const l=t(e[v]);if(l)return l;const{def:u,path:g,params:f}=e[v];if(u.tag==="composite"){if(u.value.length===0)return H;if(u.value.length===1){const d=c(u.value[0].type);return i&&g.at(-1)==="AccountId32"&&gt(d,32)?(i=!1,{type:"AccountId32"}):o&&g.at(-1)==="AccountId20"&&gt(d,20)?(o=!1,{type:"AccountId20"}):d}return h(u.value)}if(u.tag==="variant"){if(g.length===1&&g[0]==="Option"&&f.length===1&&f[0].name==="T"){const A=c(f[0].type);return A.type==="void"?{type:"primitive",value:"bool"}:{type:"option",value:A}}if(g.length===1&&g[0]==="Result"&&f.length===2&&f[0].name==="T"&&f[1].name==="E")return{type:"result",value:{ok:c(f[0].type),ko:c(f[1].type)}};if(u.value.length===0)return H;const d={},x={};return u.value.forEach(A=>{const he=A.name;if(x[he]=A.docs,A.fields.length===0){d[he]={...H,idx:A.index};return}if(A.fields.length===1&&!A.fields[0].name){d[he]={type:"lookupEntry",value:c(A.fields[0].type),idx:A.index};return}d[he]={...h(A.fields),idx:A.index}}),{type:"enum",value:d,innerDocs:x}}if(u.tag==="sequence")return{type:"sequence",value:c(u.value)};if(u.tag==="array"){const{len:d}=u.value,x=c(u.value.type);return!d||x.type==="void"?H:d>1?{type:"array",value:x,len:u.value.len}:x}if(u.tag==="tuple")return u.value.length===0?H:u.value.length>1?p(u.value.map(d=>c(d)),u.value.map(d=>e[d].docs)):c(u.value[0]);if(u.tag==="primitive")return{type:"primitive",value:u.value.tag};if(u.tag==="compact"){const d=c(u.value);return d.type==="void"?H:{type:"compact",isBig:Number(d.value.slice(1))>32,size:d.value}}return{type:u.tag}}),h=v=>{let l=!0;const u={},g={};return v.forEach((f,d)=>{l=l&&!!f.name;const x=f.name||d,A=c(f.type);A.type!=="void"&&(u[x]=A,g[x]=f.docs)}),l?{type:"struct",value:u,innerDocs:g}:p(Object.values(u),Object.values(g))},p=(v,l)=>{if(v.every(u=>u.id===v[0].id)&&l.every(u=>!u.length)){const[u]=v;return u.type==="void"?H:{type:"array",value:v[0],len:v.length}}return{type:"tuple",value:v,innerDocs:l}};return c},Kn=e=>{const t=Rn(e.lookup,({def:s})=>{if(s.tag==="composite"){const i=n(s);if(i)return{type:"enum",innerDocs:{},value:Object.fromEntries(e.pallets.map(o=>[o.name,o.errors==null?{...H,idx:o.index}:{type:"lookupEntry",value:t(o.errors),idx:o.index}])),byteLength:i}}return null});function n(s){if(!(s.value.length===2&&s.value[0].name==="index"&&s.value[1].name==="error"))return null;const o=t(s.value[0].type),c=t(s.value[1].type);return o.type==="primitive"&&o.value==="u8"&&c.type==="array"&&c.value.type==="primitive"&&c.value.value==="u8"?1+c.len:null}return Object.assign(t,{metadata:e,call:"outerEnums"in e?e.outerEnums.call:e.lookup[e.extrinsic?.type]?.params.find(o=>o.name==="Call")?.type??null})},Wn=ye(I.enc,e=>+!!e.signed<<7|e.version),Ie=()=>new Error("Unkown signer"),Xn=e=>{const{extrinsic:t}=e,n=Kn(e);let r,s;if("address"in t)r=n(t.address),s=n(t.signature);else{const i=Object.fromEntries(e.lookup[t.type].params.filter(o=>o.type!=null).map(o=>[o.name,n(o.type)]));if(r=i.Address,s=i.Signature,!r||!s)throw Ie()}if(r.type==="AccountId20"&&s.type==="array"&&s.len===65&&s.value.type==="primitive"&&s.value.value==="u8")return[1,[]];if(s.type!=="enum"||["Ecdsa","Ed25519","Sr25519"].some(i=>!(i in s.value)))throw Ie();if(r.type==="enum"){const i=r.value.Id;if(i.type==="lookupEntry"&&i.value.type==="AccountId32")return[0,[i.idx]]}else if(r.type==="AccountId32")return[0,[]];throw Ie()},Fn={Ed25519:0,Sr25519:1,Ecdsa:2},Gn=(e,t,n,r,s,i)=>{const[o,c]=Xn(e),h=G(Wn({signed:!0,version:4}),o===1?t:new Uint8Array([...c,...t]),o===1||!i?n:new Uint8Array([Fn[i],...n]),...r,s);return G(k.enc(h.length),h)},[le,ee]=["<Bytes>","</Bytes>"].map(e=>gn.fromText(e).asBytes()),zn=e=>async t=>{let n=!0,r;for(r=0;n&&r<le.length;r++)n=le[r]===t[r];n=n&&r===le.length;const s=t.length-ee.length;for(r=0;n&&r<ee.length;r++)n=ee[r]===t[s+r];return n=n&&r===ee.length,e(n?t:G(le,t,ee))};function Yn(e,t,n){return{publicKey:e,signTx:async(s,i,o,c,h=qn)=>{let p;try{const f=Pn(o);if(f.metadata.tag!=="v14"&&f.metadata.tag!=="v15")throw null;p=f.metadata.value}catch{throw new Error("Unsupported metadata version")}const v=[],l=[];p.extrinsic.signedExtensions.map(({identifier:f})=>{const d=i[f];if(!d)throw new Error(`Missing ${f} signed extension`);v.push(d.value),l.push(d.additionalSigned)});const u=G(s,...v,...l),g=await n(u.length>256?h(u):u);return Gn(p,e,g,v,s,t)},signBytes:zn(n)}}F.getPolkadotSigner=Yn});
